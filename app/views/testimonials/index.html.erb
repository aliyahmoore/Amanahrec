<h1>Testimonials</h1>

<% @testimonials.each do |testimonial| %>
  <div>
    <p><%= testimonial.text %></p>
    <small>By: <%= testimonial.user.first_name %> <%= testimonial.user.last_name %></small>

    <% if current_user&.role&.name == 'admin' %>
      <% if testimonial.approved? %>
        <p>Status: Approved</p>
        <%= button_to "Unapprove", unapprove_testimonial_path(testimonial), method: :patch, class: "btn btn-warning", data: { confirm: "Are you sure you want to unapprove this testimonial?" } %>
      <% else %>
        <p>Status: Pending Approval</p>
        <%= button_to "Approve", approve_testimonial_path(testimonial), method: :patch, class: "btn btn-success" %>
      <% end %>
      <%= button_to "Delete", testimonial_path(testimonial), method: :delete, class: "btn btn-danger", data: { confirm: "Are you sure you want to delete this testimonial permanently?" } %>
    <% end %>
  </div>
  <hr>
<% end %>

